!function(t,e){"use strict";function r(){return e}"function"==typeof define&&define.amd?define("tinysort",r):t.tinysort=e}(this,function(){"use strict";function t(t){function n(){0===arguments.length?c({}):a(arguments,function(t){c(r(t)?{selector:t}:t)}),v=M.length}function c(t){var e=!!t.selector,r=e&&":"===t.selector[0],a=o(t||{},w);M.push(o({bFind:e,bAttr:!(a.attr===l||""===a.attr),bData:a.data!==l,bFilter:r,mFilter:l,fnSort:a.sortFunction,iAsc:"asc"===a.order?1:-1},a))}function u(){a(t,function(t,e){F?F!==t.parentNode&&(k=!1):F=t.parentNode;var r=M[0],a=r.bFilter,o=r.selector,n=!o||a&&t.matchesSelector(o)||o&&t.querySelector(o),s=n?z:E,i={elm:t,pos:e,posn:s.length};A.push(i),s.push(i)}),C=z.slice(0)}function g(){z.sort(y)}function y(t,o){var n=0;for(0!==b&&(b=0);0===n&&v>b;){var l=M[b],c=l.ignoreDashes?h:p;if(a(m,function(t){var e=t.prepare;e&&e(l)}),l.sortFunction)n=l.sortFunction(t,o);else if("rand"==l.order)n=Math.random()<.5?1:-1;else{var d=i,u=e(t,l),g=e(o,l);if(!l.forceStrings){var w=r(u)?u&&u.match(c):i,y=r(g)?g&&g.match(c):i;if(w&&y){var S=u.substr(0,u.length-w[0].length),C=g.substr(0,g.length-y[0].length);S==C&&(d=!i,u=f(w[0]),g=f(y[0]))}}n=u===s||g===s?0:l.iAsc*(g>u?-1:u>g?1:0)}a(m,function(t){var e=t.sort;e&&(n=e(l,d,u,g,n))}),0===n&&b++}return 0===n&&(n=t.pos>o.pos?1:-1),n}function S(){var t=z.length===A.length;k&&t?(z.forEach(function(t){x.appendChild(t.elm)}),F.appendChild(x)):(z.forEach(function(t){var e=t.elm,r=d.createElement("div");t.ghost=r,e.parentNode.insertBefore(r,e)}),z.forEach(function(t,e){var r=C[e].ghost;r.parentNode.insertBefore(t.elm,r),r.parentNode.removeChild(r)}))}r(t)&&(t=d.querySelectorAll(t)),0===t.length&&console.warn("No elements to sort");var C,F,x=d.createDocumentFragment(),A=[],z=[],E=[],M=[],k=!0;return n.apply(l,Array.prototype.slice.call(arguments,1)),u(),g(),S(),z.map(function(t){return t.elm})}function e(t,e){var a,o=t.elm;return e.selector&&(e.bFilter?o.matchesSelector(e.selector)||(o=l):o=o.querySelector(e.selector)),e.bAttr?a=o.getAttribute(e.attr):e.useVal?a=o.value:e.bData?a=o.getAttribute("data-"+e.data):o&&(a=o.textContent),r(a)&&(e.cases||(a=a.toLowerCase()),a=a.replace(/\s+/g," ")),a}function r(t){return"string"==typeof t}function a(t,e){for(var r,a=t.length,o=a;o--;)r=a-o-1,e(t[r],r)}function o(t,e,r){for(var a in e)(r||t[a]===s)&&(t[a]=e[a]);return t}function n(t,e,r){m.push({prepare:t,sort:e,sortBy:r})}var s,i=!1,l=null,c=window,d=c.document,f=parseFloat,u=Array.prototype.indexOf,p=/(-?\d+\.?\d*)$/g,h=/(\d+\.?\d*)$/g,m=[],v=0,b=0,g="2.1.0",w={selector:l,order:"asc",attr:l,data:l,useVal:i,place:"start",returns:i,cases:i,forceStrings:i,ignoreDashes:i,sortFunction:l};return c.Element&&function(t){t.matchesSelector=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector||function(t){for(var e=this,r=(e.parentNode||e.document).querySelectorAll(t),a=-1;r[++a]&&r[a]!=e;);return!!r[a]}}(Element.prototype),o(n,{indexOf:u,loop:a}),o(t,{plugin:n,version:g,defaults:w})}()),function(t){function e(t){var e=t.data("bootstrap-sortable-context");return null==e&&(e={bsSort:[],lastSort:null},t.data("bootstrap-sortable-context",e)),e}function r(t,e){tinysort(t,e)}function a(r,s){var i=parseFloat(r.attr("data-sortcolumn")),l=e(s),c=l.bsSort,d=r.attr("colspan");if(d){var f=Math.min(d-1,parseFloat(r.data("mainsort"))||0),u=parseFloat(r.data("sortkey").split("-").pop());if(s.find("thead tr").length-1>u)return void a(s.find('[data-sortkey="'+(i+f)+"-"+(u+1)+'"]'),s);i+=f}var p=r.attr("data-defaultsign")||o;if(s.find("th").each(function(){t(this).removeClass("up").removeClass("down").addClass("nosort")}),t.browser.mozilla){var h=s.find("div.mozilla");void 0!==h&&(h.find(".sign").remove(),h.parent().html(h.html())),r.wrapInner('<div class="mozilla"></div>'),r.children().eq(0).append('<span class="sign '+p+'"></span>')}else s.find("span.sign").remove(),r.append('<span class="sign '+p+'"></span>');var m=r.attr("data-sortkey"),v="desc"!==r.attr("data-firstsort")?"desc":"asc";l.lastSort=m,c[m]="asc"===(c[m]||v)?"desc":"asc","desc"===c[m]?(r.find("span.sign").addClass("up"),r.addClass("up").removeClass("down nosort")):r.addClass("down").removeClass("up nosort");var b=s.children("tbody").children("tr");n(b,{selector:"td:nth-child("+(i+1)+")",order:c[m],data:"value"}),s.find("td.sorted, th.sorted").removeClass("sorted"),b.find("td:eq("+i+")").addClass("sorted"),r.addClass("sorted")}var o,n,s=t(document);if(t.bootstrapSortable=function(s,i,l){var c="undefined"!=typeof moment;o=i?i:"arrow","default"==l&&(l=r),n=l||n||r,t("table.sortable").each(function(){var r=t(this),o=e(r),n=o.bsSort;s=s===!0,r.find("span.sign").remove(),r.find("thead [colspan]").each(function(){for(var e=parseFloat(t(this).attr("colspan")),r=1;e>r;r++)t(this).after('<th class="colspan-compensate">')}),r.find("thead [rowspan]").each(function(){for(var e=t(this),r=parseFloat(e.attr("rowspan")),a=1;r>a;a++){var o=e.parent("tr"),n=o.next("tr"),s=o.children().index(e);n.children().eq(s).before('<th class="rowspan-compensate">')}}),r.find("thead tr").each(function(e){t(this).find("th").each(function(r){var a=t(this);a.addClass("nosort").removeClass("up down"),a.attr("data-sortcolumn",r),a.attr("data-sortkey",r+"-"+e)})}),r.find("thead .rowspan-compensate, .colspan-compensate").remove(),r.find("td").each(function(){var e=t(this);void 0!==e.attr("data-dateformat")&&c?e.attr("data-value",moment(e.text(),e.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss")):void 0===e.attr("data-value")&&e.attr("data-value",e.text())}),r.find('thead th[data-defaultsort!="disabled"]').each(function(e){var r=t(this),i=r.closest("table.sortable");r.data("sortTable",i);var l=r.attr("data-sortkey"),c=s?o.lastSort:-1;n[l]=s?n[l]:r.attr("data-defaultsort"),void 0!==n[l]&&s===(l===c)&&(n[l]="asc"===n[l]?"desc":"asc",a(r,i))}),r.trigger("sorted")})},s.on("click",'table.sortable thead th[data-defaultsort!="disabled"]',function(e){var r=t(this),o=r.data("sortTable")||r.closest("table.sortable");o.trigger("before-sort"),a(r,o),o.trigger("sorted")}),!t.browser){t.browser={chrome:!1,mozilla:!1,opera:!1,msie:!1,safari:!1};var i=navigator.userAgent;t.each(t.browser,function(e){t.browser[e]=new RegExp(e,"i").test(i)?!0:!1,t.browser.mozilla&&"mozilla"===e&&(t.browser.mozilla=new RegExp("firefox","i").test(i)?!0:!1),t.browser.chrome&&"safari"===e&&(t.browser.safari=!1)})}t(t.bootstrapSortable)}(jQuery);
